<!DOCTYPE HTML>
<html>
<head>
<meta charset="UTF-8">
<title>JavaScript Compiler Interpreter</title>
<style>
#ELicense
{
	float: right;
}
#source
{
	font-size: 20px;
	width: 48%;
	height: 425px;
	font-family: Monaco, Courier New;
	overflow: auto;
	margin: 0;
	border: 1;
	padding: 0 0 0 5px;
}
#runtime
{
	font-size: 20px;
	width: 48%;
	height: 425px;
	font-family: Monaco, Courier New;
	overflow: auto;
	margin: 0;
	border: 1;
	padding: 0 0 0 5px;
}
#output, #log
{
	font-family: Monaco, Courier New;
	line-height: 1.3em;
	font-size: 18px;
	z-index: 10;
}
</style>
<link rel="stylesheet" href="ui-lightness/jquery-ui-1.8.20.custom.css" />
<script type="text/javascript" src="jquery.min.js"></script>
<script type="text/javascript" src="jquery-ui.min.js"></script>
<script type="text/javascript" src="jsMap.js"></script>
<script type="text/javascript" src="jsStack.js"></script>
<script type="text/javascript" src="jsScanner.js"></script>
<script type="text/javascript" src="jsNgCore.js"></script>
<script type="text/javascript" src="jsCI.js"></script>
<script type="text/javascript">
/*
This file is part of JavaScript Compiler Interpreter.
 
JavaScript Compiler Interpreter is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.
 
JavaScript Compiler Interpreter is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.
 
You should have received a copy of the GNU General Public License
along with JavaScript Compiler Interpreter.  If not, see <http://www.gnu.org/licenses/>.
*/
function wshOpenFile(name)
{
	var lines = new JSLineFile(name);
	var text = "";
	while(lines.hasNext())
	{
		text += lines.nextLine()+" ";
	}
	return text;
}
function jsIn()
{
	// would really like to read this from the textarea
	return prompt("The script is requesting input");
}
function jsOut(output)
{
	$("#runtime").val($("#runtime").val()+"\n"+output);
}
var tokens = loadTokens("tokens");
var grammar = wshOpenFile("grammar");
var tiny = new jsCI(tokens, "program", grammar);
var output;
$(document).ready(function()
{
	$("#tabs").tabs(
	{
		"selected":0,
		"select": function(e,t)
		{
			if(t.index == 3 && $("#grammar").text()=="")
				$("#grammar").html(tiny.toString().replace(/\\n/g,"<br />"));
		}
	});
	$("#input").submit(function()
	{
		var source = $("#source").val();
		output = tiny.compile(source);
		$("#output").text(output);
		eval(output);
		return false;
	});
	
});
function loadTokens(path)
{
	var terms = new Array();
	var tokens = new JSLineFile(path);
	while(tokens.hasNext())
	{
		var token = tokens.nextLine().split(/ :\= /);
		terms[token[0]] = token[1];
	}
	return terms;
}
</script>
</head>
<body>
<a id="ELicense" rel="license" href="http://www.gnu.org/licenses/gpl.html"><img alt="GPL" style="border-width:0" src="http://www.gnu.org/graphics/gplv3-88x31.png" /></a>
<h3>JavaScript Compiler Interpreter</h3>
<div id="tabs">
	<ul>
		<li><a href="#ETabInst">Instructions</a></li>
		<li><a href="#ETabSource">Source Code</a></li>
		<li><a href="#ETabTarget">Target Code</a></li>
		<li><a href="#ETabGrammar">Grammar</a></li>
	</ul>
	<div id="ETabInst">
		<p>This is a VERY raw compiler--there is virtually no error checking, absolutely no type checking--but for a first effort, I'm pretty happy with this rough sketch.  jsCI can parse any grammar given to it.  This demo includes the grammar for a language called Tiny.  Check the Grammar tab to familiarize yourself with Tiny's syntax or view the grammar <a href="grammar">source</a>.  The terminals are listed &lt;symbol&gt;: &lt;regex&gt; and "&" is used in place of &#949;.  Enter your source code in the left panel on the Source tab.  Execution occurs in the right panel and the generated target code will appear on the Target tab.</p>
		<p>I'm releasing the JavaScript Compiler Interpreter under the GNU Public License (GPL).  Feel free to do with this whatever you'd like.  Please send me your programs, bug reports, or even your own grammars (<a href="mailto:brotplot@wi.rr.com">email</a>).  I'd love to know how my work is being used by others.</p>
	</div>
	<div id="ETabSource">
		<form id="input">
			<input type="submit" value="Run" class="run" id="run"/>
			<div>
				<textarea id="source" wrap="off">
write "Tiny powers";
Accum := 0;
Counter := 1;
msgA := "Enter base";
msgB := "Enter exponent";
write msgA; read myVarA; write myVarA;
write msgB; read myVarB; write myVarB;
if myVarB > 0 then
	Accum := myVarA;
	repeat
		Accum := Accum * myVarA;
		Counter := Counter + 1
	until Counter = myVarB;
	write Accum
else
	write "ERROR"
end</textarea>
				<textarea id="runtime"></textarea>
			</div>
			<ul id="log" style="list-style-type: none"></ul>
		</form>
	</div>
	<div id="ETabTarget">
		<p id="output"></p>
	</div>
	<div id="ETabGrammar">
		<p id="grammar"></p>
	</div>
</div>
</body>
</html>